<!doctype html>
<html lang="en">
	<head>
		<style type="text/css">
			body
			{
				margin: 0;
				background-color: black;
			}

			/* Всплывающее окно */

			.parent_popup, .parent_popup_click
			{
				background-color: rgba(0, 0, 0, 0.8);
				display: none;
				position: fixed;
				z-index: 99999;
				top: 0;
				right: 0;
				bottom: 0;
				left: 0;
			}
			.popup, .popup_click
			{
				background: rgba(117, 195, 241, 1);
				max-width: 600px;
				width: 70%;
				margin: 5% auto;
				padding: 5px 20px 13px 20px;
				border: 10px solid #fff;
				position: relative;
				/*--CSS3 CSS3 Тени для Блока--*/
				-webkit-box-shadow: 0px 0px 20px #000;
				-moz-box-shadow: 0px 0px 20px #000;
				box-shadow: 0px 0px 20px #000;
				/*--CSS3 Закругленные углы--*/
				-webkit-border-radius: 10px;
				-moz-border-radius: 10px;
				border-radius: 10px;
				font-size: 28px;
			}


			.popup h2, .popup_click h2
			{
				font: 36px EtoMoiFont;
				font-weight: bold;
				text-align: center;
				color: #ECB42A;
				text-shadow: 1px 1px 10px rgba(0,0,0,1.0);
			}

			.popup_click button
			{
				font: 32px EtoMoiFont;
				color: #ECB42A;
				border: 3px solid #fff;
				background-color: rgba(116, 195, 241, 1);
				-webkit-border-radius: 10px;
				-moz-border-radius: 10px;
				border-radius: 10px;
				padding: 5px 10px;
				text-shadow: 1px 1px 5px rgba(0,0,0,1.0);
				margin-top: 30px;
			}

			.popup_click button:hover
			{
				background: #a6d9f7;
			}

			.popup_click button:active
			{
				background: rgba(78, 117, 241, 0.5);
			}
			/* кнопка закрытия */
			.close
			{
				background-color: rgba(0, 0, 0, 0.8);
				border: 2px solid #ccc;
				height: 24px;
				line-height: 24px;
				position: absolute;
				right: -24px;
				cursor: pointer;
				text-align: center;
				text-decoration: none;
				color: rgba(255, 255, 255, 0.9);
				font-size: 14px;
				font-family: helvetica, arial;
				text-shadow: 0 -1px rgba(0, 0, 0, 0.9);
				top: -24px;
				width: 24px;
				-webkit-border-radius: 15px;
				-moz-border-radius: 15px;
				-ms-border-radius: 15px;
				-o-border-radius: 15px;
				border-radius: 15px;
				-moz-box-shadow: 1px 1px 3px #000;
				-webkit-box-shadow: 1px 1px 3px #000;
				box-shadow: 1px 1px 3px #000;
			}
			.close:hover
			{
				background-color: rgba(255, 69, 0, 0.8);
			}
			
			#ssylka:hover {
				color: #ff0000;
			}
		</style>
		<meta charset="UTF-8" />
		<meta http-equiv="Cache-Control" content="no-store">
		<title>
			Phaser - Making your first game, part 1
		</title>
		<link href="css/jquery-ui.css" rel="stylesheet">
		<script type="text/javascript" src="js/phaser.js">
		</script>
		<script type="text/javascript" src="js/player.js?v=2">
		</script>
		<script type="text/javascript" src="js/AJAX.js?v=1">
		</script>

		<link rel="stylesheet" type="text/css" href="css/demo.css" />
		<link rel="stylesheet" type="text/css" href="css/elastislide.css" />
		<link rel="stylesheet" type="text/css" href="css/custom.css" />
		<script type="text/javascript" src="js/jquery-2.2.1.min.js">
		</script>
		<script src="js/modernizr.custom.17475.js">
		</script>
		<script type="text/javascript" src="js/jquery.elastislide.js">
		</script>
		<link href="css/tipTip.css" rel="stylesheet" type="text/css">
		<link href="css/footer.css" rel="stylesheet" type="text/css">
		<script type="text/javascript" src="js/jquery.tipTip.js">
		</script>
	</head>
	<body>
		<div id="loadGame" style="max-width: 810px; max-height: 720px; height: 720px; background-image: url(/img/nachaloZagruzki.png);">
			<img width="60px" height="60px" src="/img/preloadLoad.gif" style="position: relative; top: 530px; left: 390px;"/>
		</div>
		<div id="game" style="max-width: 810px; max-height: 585px; margin-bottom: 5px;">
		</div>

		<div id="parent_popup_click1" class="parent_popup_click">
			<div class="popup_click">
				<h2>
					Позови друзей и получи бонус!
				</h2>
				<center id="text">
					Тут может быть абсолютно любой html или даже скрипты
				</center>
				<a class="close" title="Закрыть" onclick="document.getElementById('parent_popup_click1').style.display='none';">
					X
				</a>
				<center>
					<button onclick="addUserVk();">
						Позвать друзей
					</button>
				</center>
			</div>
		</div>

		<div id="parent_popup_click2" class="parent_popup_click">
			<div class="popup_click">
				<h2>
					Конкурсы!!!
				</h2>
				<center>
					У нас скоро будет конкурс! Будем разыгрывать монеты и призы! Подписывайтесь и следите за новостями! Подробности в нашей группе
					<b>
						<em>
							<a id="ssylka" href="https://new.vk.com/naturalrelax" target="_blank">
								Пазл: Природный калейдоскоп
							</a>
						</em>
					</b>.<!--<br><br>
					Если у Вас отображается или работает что-то не так, то нажмите комбинацию клавиш
					<b>
						<em>
							Ctrl+F5
						</em>
					</b> для обновления игры).-->
				</center>
				<a class="close" title="Закрыть" onclick="document.getElementById('parent_popup_click2').style.display='none';">
					X
				</a>
			</div>
		</div>
		<!--Слайдер друзей-->
		<div class="container demo-4">

			<div class="main">

				<div class="gallery">
					<!-- Elastislide Carousel -->
					<ul id="carousel" class="elastislide-list">
						<li>
							<a href="#" onclick="document.getElementById('parent_popup_click1').style.display='block';" class="tip" title="Позови друзей и получи бонус!">
								<img src="img/plus.png" alt="Добавить" />
							</a>
						</li>
					</ul>
					<!-- End Elastislide Carousel -->
				</div>


			</div>
		</div>
		<!-- Загрузка -->
		<script src="//vk.com/js/api/xd_connection.js?2" type="text/javascript">
		</script>
		<script>
			var player;
			(function (d)
				{
					var wf = d.createElement('script'), s = d.scripts[0];
					wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js';
					s.parentNode.insertBefore(wf, s);
				})(document);

			WebFontConfig =
			{
				active: function ()
				{
					VK.init(function ()
						{
							// узнаём flashVars, переданные приложению GET запросом. Сохраняем их в переменную flashVars
							var parts = document.location.search.substr(1).split("&");
							var flashVars =
							{
							}, curr;
							for (i = 0; i < parts.length; i++)
							{
								curr = parts[i].split('=');
								// записываем в массив flashVars значения. Например: flashVars['viewer_id'] = 1;
								flashVars[curr[0]] = curr[1];
							}

							// получаем viewer_id из полученных переменных
							var viewer_id = flashVars['viewer_id'];
							var priglasil = flashVars['user_id'] // Ид пригласившего
							player = new Player();
							AJAX.getDataUser(player, viewer_id, priglasil);
							player.uid = viewer_id;
							$('#parent_popup_click1 > div.popup_click > #text').html('<br>Отправьте приглашение в игру друзьями или поделитесь с ними вот этой ссылкой: <b><em>https://vk.com/app5314962_' + player.uid + '</em></b><br />и получите от нас бонус!!! ;)<br>');

						}, function ()
						{
							// API initialization failed
							// Can reload page here
						}, '5.52');

					// Загрузка друзей вк в приложение
					VK.api('friends.getAppUsers',function(data)
						{
							if (data.response)
							{
								var idFriend = '';
								for(var i = 0; i < data.response.length; i++)
								{
									if(i != data.response.length-1)
										idFriend += data.response[i] + ', ';
									else
										idFriend += data.response[i];
								}
								VK.api('users.get',
										{
											user_ids: idFriend, fields: 'photo_100'
										},function(data2)
										{
											for(var i = 0; i < data.response.length; i++)
												AJAX.getDataFriends(data2.response[i]['id'], data2.response[i]['photo_100'], data.response.length);
										});
							}
						});
				},
				custom:
				{
					families: ['EtoMoiFont', "DS Eraser Cyr"],
					urls: ['css/shrift.css']
				},
			};
		</script>
		<script type="text/javascript">
			var game;

			var mainDisplayGroup, listLevelsGroup, playGroup; // Основные группы переходов

			var settingGroup; // Группа настрое
			var settingGroupAnim; //Группа для анимации открытия настроек
			var levelsGroup, levelsGroup2;

			var buttonFullScreen; // Кнопка НА весь экран
			var rulesGroup, magazGroup; // Окно с правилами
			var reitingGroup;

			var progressBar, progressBarFon;

			var buttonBackPlay;

			var buttonHelpTime, buttonHelpMove, buttonHelpShow;
			var muzica;

			var buttonMusic, buttonSound;
			var knopkaDalee, buttonProgress;

			function createText()
			{
				// Создание игры
				game = new Phaser.Game(1800, 1300, Phaser.AUTO, document.getElementById('game'), { preload: preload, create: create, update: update });

				//Функция предзагрузки
				function preload()
				{
					// Загрузка "Загрузка"
					game.load.image("loading", "img/load.png");
					game.load.image("fonLoad", "img/fonLoad.png");

					//Делаем адаптивный экран
					game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
					game.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;
					game.scale.refresh();

					//Загружаем изображения
					game.load.image("fon", "img/fon.jpg");
					game.load.image("gameplay", "assets/Level1/success.jpg");
					game.load.image("ramka", "img/ramkaPolya.png");
					game.load.spritesheet("setting", "img/icon/setting.png", 126, 126);
					game.load.image("settingFon", "img/fonSetting.jpg");
					game.load.spritesheet("music", "img/icon/music.png", 126, 126);
					game.load.spritesheet("sound", "img/icon/sound.png", 126, 126);
					game.load.spritesheet("notmusic", "img/icon/notmusic.png", 126, 126);
					game.load.spritesheet("notsound", "img/icon/notsound.png", 126, 126);
					game.load.spritesheet("back", "img/icon/back.png", 126, 126);
					game.load.image("money", "img/coins.png");

					//Загрузка блоков уровней
					game.load.spritesheet("levels", "img/level/lvl.png", 196, 197);
					game.load.image("zamok", "img/level/close.png");
					game.load.spritesheet("nextLevel", "img/icon/next.png", 126, 126);
					game.load.spritesheet("backLevel", "img/icon/return.png", 126, 126);

					game.load.spritesheet("up", "img/icon/up.png", 126, 126);
					game.load.spritesheet("down", "img/icon/down.png", 126, 126);

					// Кнопки основного экрана
					game.load.spritesheet("magazButton", "img/magaz.png", 482, 136);
					game.load.spritesheet("levelsButton", "img/levels.png", 482, 136);
					game.load.spritesheet("rulesButton", "img/rules.png", 482, 136);
					game.load.spritesheet("reitingButton", "img/reiting.png", 482, 136);
					game.load.spritesheet("fullScreen", "img/fullScreen.png",254,212);
					game.load.spritesheet("outFullScreen", "img/outFullScreen.png",254,212);

					//Диалоговое окно
					game.load.image("dialogPravila", "img/fonPravila.png");
					game.load.image("dialog", "img/dialog.png");
					game.load.image("dialogReyting", "img/fonReyting.png");
					game.load.image("plus", "img/plus.png");
					game.load.spritesheet("okey", "img/ok.png", 212, 216);
					game.load.image("tiptool", "img/tooltip.png");
					game.load.image("tiptoolProgress", "img/tooltipProgress.png");
					game.load.image("helpProgress", "img/helpProgress.png");
					game.load.image("kupit", "img/kupit.png");
					game.load.image("magazFull", "img/magazFull.png");
					game.load.spritesheet("button5", "img/buttonMagaz/5.png", 291, 155);
					game.load.spritesheet("button9", "img/buttonMagaz/9.png", 291, 155);
					game.load.spritesheet("button21", "img/buttonMagaz/21.png", 291, 155);
					game.load.spritesheet("button38", "img/buttonMagaz/38.png", 291, 155);
					game.load.spritesheet("button125", "img/buttonMagaz/125.png", 291, 155);

					// Загрузка звуков и музыки
					game.load.audio("click", "sound/click.mp3");
					game.load.audio("win", "sound/win.mp3");
					game.load.audio("overButton", "sound/overButton.mp3");
					game.load.audio("muzica", "sound/muzica.mp3");
					game.load.audio("listat", "sound/listat.mp3");
					game.load.audio("peremeshhenie", "sound/peremeshhenie.mp3");
					game.load.audio("tik", "sound/tikanie.mp3");

					// Загрузка подсказок
					game.load.spritesheet("time", "img/help/time2.png", 112, 112);
					game.load.spritesheet("progress", "img/help/progress.png", 112, 112);
					game.load.spritesheet("move", "img/help/move.png", 112, 112);
					game.load.spritesheet("show", "img/help/show.png", 112, 112);
				}

				//Функция создания
				function create()
				{
					settingGroup = game.add.group(); // Группа настрое
					settingGroupAnim = game.add.group(); //Группа для анимации открытия настроек
					//levelsGroup = game.add.group(), levelsGroup2 = game.add.group();
					settingGroupAnim.hidden = true;
					settingGroup.position.set(1640, 850);
					game.add.sprite(0, 0, "fon");

					//Загрузка настроек
					buttonMusic = game.add.button(-20, -24, "music", actionMusicClick, this, 1,0,2,0);
					buttonSound = game.add.button(-20, 116, "sound", actionSoundClick, this, 1,0,2,0);
					settingGroupAnim.add(buttonMusic);
					settingGroupAnim.add(buttonSound);
					settingGroupAnim.position.set(0, 330);
					settingGroup.add(settingGroupAnim);
					settingGroup.add(game.add.sprite(-50, 312, "settingFon"));
					var but = game.add.button(-20, 256, "setting", actionSettingClick, settingGroupAnim, 1,0,2,0);
					settingGroup.add(but);
					game.world.bringToTop(settingGroup);

					// Спрайт табло с монетами
					var money = game.add.sprite(10, -250, "money");
					money.width = 700;
					money.height = 700;

					// Отображение текста с монетами
					var t = game.add.text(300, 60, player.money, { font: "bold 60px EtoMoiFont", fill: "#FFD300", stroke: '#000000', strokeThickness: 10 });
					player.textMoney = t;
					// Добавляем кнопку "FullScreen"
					buttonFullScreen = game.add.button(1650, 50, 'fullScreen', actionFullScreen, this, 1, 0, 2, 0);
					buttonFullScreen.fullScreen = false;
					buttonFullScreen.width = 100;
					buttonFullScreen.height = 100;

					//Добавляем окно с правилами
					rulesGroup = game.add.group();
					rulesGroup.add(game.add.sprite(226, 204, "dialogPravila"));
					rulesGroup.add(game.add.text(720, 230, "Правила", { font: "bold 120px EtoMoiFont", fill: "#fff"}));
					var backRules = game.add.button(50, 1100, "back", actionBackClickRules, backRules, 1, 0, 2, 0);
					rulesGroup.add(backRules);
					rulesGroup.scale.set(0, 0);
					rulesGroup.visible = false;

					//Добавляем текст правил
					var massivGroup = new Array();
					massivGroup[0] = game.add.group();
					massivGroup[0].add(game.add.text(350, 350, "Игра с расслабляющей музыкой и красивыми видами\nприроды поможет Вам расслабиться, получить\nудовольствие от пейзажей и окунутся в реальный мир,\nпро который мы порой забываем... Примите расслабляющую\nпозу, устройтесь поудобнее, наслажайтесь звуками природы\nи попробуйте собрать картины с изображениями, на которых\nизображены красивые уголки нашей природы из разным мест\nи стран. Теперь о самой игре и что Вас в ней ждет:\n1. Многообразие уровней и разновидность сложности;\n2. Рейтинговая таблица;\n3. Ваши друзья и их данные в игре;\n4. Подсказки;\n5. И конечно же приятная атмосфера!", { font: "bold 40px EtoMoiFont", fill: "#fff"}));
					massivGroup[1] = game.add.group();
					massivGroup[1].add(game.add.text(350, 350, "Цель игры: собрать пейзажи природы, окунутся в\nэту картину и получить приятные эмоции!\nВам предстоит переставить блоки, на которые\nподелена картина, в правильном порядке. Каждый блок имеет\nразличный фиксированный размер, но при перестановке блоков,\nони менятся своими размерами. Для достижения\nположительного результата Вам помогут подсказки!\n        Подсказка 'Перемеcтить случайный пазл'. Выбирается\n        случайный пазл и ставиться в правильное место,\nа другой пазл перемещается на его место, соответственно.\n        Подсказка 'Показать готовую картинку'. Отображает\n        собранный пазл на некоторое время, чтобы\nвы могли понять, куда пазл нужно переставлять!", { font: "bold 40px EtoMoiFont", fill: "#fff"}));
					massivGroup[1].add(game.add.sprite(400, 690, "move"));
					massivGroup[1].add(game.add.sprite(400, 835, "show"));

					massivGroup[2] = game.add.group();
					massivGroup[2].add(game.add.text(350, 350, "        Подсказка 'Добавить время'. Уровень,\n        который нужно будет пройти на время, и\nесли Вам не хватит времени, то это подсказка поможет\nВам его прибавить!\n        Подсказка 'Показать прогресс игры'. Индикатор\n        с полоской и процентов, показывающий процент\n        собранности картинки данного уровня. Вы можете\n        пригласить друзей в игру и за это получить бонус!\n        Для этого нужно прислать приглашение, кликнув\n        плюсик, либо поделиться вашей персональной\n        ссылкой с другом) Дополнительная информация,\n        помощь и конкурсы в нашейгруппе:\n        http://vk.com/naturalrelax\n        Хорошего Вам наслаждения!", { font: "bold 40px EtoMoiFont", fill: "#fff"}));
					massivGroup[2].add(game.add.sprite(400, 340, "time"));
					massivGroup[2].add(game.add.sprite(400, 600, "helpProgress"));

					massivGroup[1].visible = false;
					massivGroup[2].visible = false;
					massivGroup.idex = 0;
					rulesGroup.add(massivGroup[0]);
					rulesGroup.add(massivGroup[1]);
					rulesGroup.add(massivGroup[2]);

					// Добавляем стрелки
					var upButton = game.add.button(1300, 350, "up", upStrel, massivGroup, 1,0,2,0);
					var downButton = game.add.button(1300, 990, "down", downStrel, massivGroup, 1,0,2,0);
					rulesGroup.add(upButton);
					rulesGroup.add(downButton);

					function upStrel()
					{
						if(this.idex > 0)
						{
							if (player.sound)
							{
								var click = game.add.audio("click");
								click.play();
							}
							this[this.idex].visible = false;
							this.idex -= 1;
							this[this.idex].visible = true;
						}
					}

					function downStrel()
					{
						if(this.idex < 2)
						{
							if (player.sound)
							{
								var click = game.add.audio("click");
								click.play();
							}
							this[this.idex].visible = false;
							this.idex += 1;
							this[this.idex].visible = true;
						}
					}

					//Добавляем окно Магазин
					magazGroup = game.add.group();
					magazGroup.add(game.add.sprite(0, 0, "dialog"));
					magazGroup.add(game.add.text(750, 150, "Магаз", { font: "bold 120px EtoMoiFont", fill: "#FFD300", stroke: "#000000", strokeThickness: 10 }));
					magazGroup.add(game.add.sprite(300, 350, "magazFull"));
					magazGroup.add(game.add.button(1150, 375, "button5", actionButtonKupit, '1000monet', 1, 0, 2, 0));
					magazGroup.add(game.add.button(1150, 545, "button9", actionButtonKupit, '2000monet', 1, 0, 2, 0));
					magazGroup.add(game.add.button(1150, 715, "button21", actionButtonKupit, '5000monet', 1, 0, 2, 0));
					magazGroup.add(game.add.button(1150, 885, "button38", actionButtonKupit, '10000monet', 1, 0, 2, 0));
					magazGroup.add(game.add.button(1150, 1055, "button125", actionButtonKupit, '50000monet', 1, 0, 2, 0)); //1 - Наведен, 2 - отведен, 3 нажат 4 отжат
					var backMagaz = game.add.button(50, 1100, "back", actionBackClickMagaz, backMagaz, 1, 0, 2, 0);
					magazGroup.add(backMagaz);
					magazGroup.scale.set(0, 0);
					magazGroup.visible = false;

					// Добавляем в основную группу listLevelsGroup
					listLevelsGroup = game.add.group();

					initLevelsGroup();

					// Кнопка назад
					listLevelsGroup.add(game.add.button(50, 1100, "back", actionBackClick, this, 1, 0, 2, 0));
					//Загрузка кнопок "Вперед", "Назад"
					listLevelsGroup.add(game.add.button(50, 620, "backLevel", backLevels, this, 1,0,2,0));
					listLevelsGroup.add(game.add.button(1610, 620, "nextLevel", nextLevels, this, 1,0,2,0));
					listLevelsGroup.position.set(1800, 0);

					// Инициализация функций загрузки
					game.load.onLoadStart.add(loadStart, this);
					game.load.onFileComplete.add(fileComplete, this);
					game.load.onLoadComplete.add(loadComplete, this);

					progressBar = game.add.sprite(game.world.centerX, game.world.centerY, 'loading');
					progressBarFon = game.add.sprite(300, 600, 'fonLoad');
					progressBarFon.visible = false;
					game.world.moveDown(progressBarFon)
					progressBar.position.set(300, 600);
					game.load.setPreloadSprite(progressBar);

					// Загрузка основного экрана
					mainDisplayGroup = game.add.group();
					mainDisplayGroup.add(game.add.button(660, 500, "magazButton", actionButtonMagaz, this, 1,0,2,0));
					mainDisplayGroup.add(game.add.button(660, 350, "levelsButton", actionButtonLevels, this, 1,0,2,0));
					mainDisplayGroup.add(game.add.button(660, 650, "reitingButton", actionButtonReiting, this, 1,0,2,0));
					mainDisplayGroup.add(game.add.button(660, 800, "rulesButton", actionButtonRules, this, 1,0,2,0));

					// Подсчет дней в игре
					var vremya = new Date();
					if((vremya.getTime() - player.timesDays) > 172800000)
					{
						player.days = 1;
						player.timesDays = vremya.getTime();
						AJAX.saveTimes(player);
						diologPrivetstviya();
					}

					if((vremya.getTime() - player.timesDays >= 86400000 && vremya.getTime() - player.timesDays <= 2*86400000) || player.days == 0)
					{
						if(player.days <= 5)
						player.days++;
						player.timesDays = vremya.getTime();
						AJAX.saveTimes(player);
						diologPrivetstviya();
					}

					function diologPrivetstviya()
					{
						// Отключаем нажатие кнопок
						for(var i = 0; i<4; i++)
						{
							mainDisplayGroup.children[i].inputEnabled = false;
						}
						// Отобразить диалог дней прихода
						var groupDialogDays = game.add.group();
						var fon = game.add.sprite(0, 0, "dialog");
						fon.width = 1200;
						fon.height = 1000;
						groupDialogDays.add(fon);

						var opoveshhenie = "";
						var width = 220;
						switch(player.days)
						{
							case 1: opoveshhenie = "Вы зашли 1й день!\nПолучите от нас 100 монет!\nЗаходите чаще и\nполучайте больше!!!";
							player.money += 100;
							break;

							case 2: opoveshhenie = "Вы зашли 2й день!\nТак держать!\nПолучите от нас 200 монет!";
							player.money += 200;
							break;

							case 3: opoveshhenie = "Вы зашли 3й день!\nЕще один день\nна едине с природой!\nПолучите от нас 400 монет!";
							player.money += 400;
							break;

							case 4: opoveshhenie = "Вы зашли 4й день!\nВидим Вам понравилось!\nПолучите от нас 750 монет!";
							player.money += 750;
							break;

							case 5: opoveshhenie = "Вы зашли 5й день!\nПолучайте удовольствие\nот природы\nВот Вам 1000 монет!";
							player.money += 1000;
							width = 300;
							break;

							case 6: opoveshhenie = "За хорошее посещение\nВам монетки от заведения\nВот Вам 1000 монет!";
							player.money += 1000;
							width = 260;
							break;
						}
						player.textMoney.setText(player.money);
						// Сохранение данных
						AJAX.saveData(player);

						groupDialogDays.add(game.add.text(width, 280, opoveshhenie, { font: "bold 60px EtoMoiFont", fill: "#FFD300", stroke: '#000000', strokeThickness: 10 , align: "center"}));

						groupDialogDays.add(game.add.text(410, 100, "Приветствие", { font: "bold 80px EtoMoiFont", fill: "#FFD300", stroke: '#000000', strokeThickness: 10 }));

						var button = game.add.button(540, 640, "okey", actionOk, this, 1, 0, 2, 0);
						button.scale.set(0.5, 0.5);
						groupDialogDays.add(button);
						game.world.bringToTop(groupDialogDays);
						groupDialogDays.scale.set(0, 0);
						groupDialogDays.position.set(game.world.width / 2, game.world.height / 2);
						groupDialogDays.alpha = 0;

						game.add.tween(groupDialogDays.scale).to({ x: 1, y: 1 }, 500, 'Linear', true, 0);
						game.add.tween(groupDialogDays).to({ x: game.world.width / 2 - 600, y: game.world.height / 2 - 500, alpha: 1 }, 500, 'Linear', true, 0);

						function actionOk()
						{
							// Включаем нажатие кнопок
							for(var i = 0; i<4; i++)
							{
								mainDisplayGroup.children[i].inputEnabled = true;
							}
							game.add.tween(groupDialogDays.scale).to({ x: 0, y: 0 }, 500, 'Linear', true, 0);
							game.add.tween(groupDialogDays).to({ x: game.world.width / 2, y: game.world.height / 2, alpha: 0, visible: false }, 500, 'Linear', true, 0);
						}
					}

					// Запускаем музыку
					muzica = game.add.audio("muzica");
					muzica.loop = true;
					muzica.play();

					// Инициализация подсказки всплывающей
					$("a.tip").tipTip({maxWidth: "auto", defaultPosition: "top"});

					// Скрыть экран загрузки
					$('#loadGame').slideUp("slow");

					//Отобразить диалог
					document.getElementById('parent_popup_click2').style.display='block';

					//Обработка нажатия escape
					game.input.keyboard.addCallbacks(this, function()
						{
							if(game.input.keyboard.isDown(Phaser.KeyCode.ESC) && buttonFullScreen.fullScreen)
							{
								game.scale.stopFullScreen();
								buttonFullScreen.loadTexture("fullScreen", 0);
							}
						});
				}

				//Функция обновления (каждый шаг)
				function update()
				{

				}
			} //Вызывается после загрузки шрифта

			//Функция отображения группы списка уровней
			function loadingListLevels(group, pos_x, pos_y, number)
			{
				var x = 0;
				var y = 0;
				for (var i = 1; i < 21; i++)
				{
					var style =
					{
						font: "80px EtoMoiFont", fill: "#ffffff", wordWrap: true, wordWrapWidth: 300, align: "center"
					};
					var text = game.add.text(Math.floor(x + 300 / 2), Math.floor(y + 300 / 2), number, style);
					var temp = game.add.button(x+56, y+56, "levels", upLevels, text, 1, 0, 2, 0);
					if (number > player.level)
					{
						// Уровень игрока
						temp.loadTexture("zamok", 0);
						text.visible = false;
					} else
					{
						text.visible = true;
					}
					number++;

					text.stroke = '#000000';
					text.strokeThickness = 5;
					text.setShadow(1, 1, 'rgba(0, 0, 0, 1)', 2);
					text.anchor.set(0.5);
					group.add(temp);
					group.add(text);

					if (x == 920)
					{
						y += 230;
						x = 0;
					} else x += 230;
				}
				group.position.add(pos_x, pos_y);
				game.world.bringToTop(group);
			}

			// Функция анимации прокрутки списка уровней
			function animaciaLevels(pos_x, change_x1, change_x2)
			{
				if (game.naFone == 1)
				{
					textChange(levelsGroup2, pos_x, 200);
					game.add.tween(levelsGroup).to({ x: change_x1 }, 150, 'Linear', true);
					game.add.tween(levelsGroup2).to({ x: change_x2 }, 150, 'Linear', true);
					game.naFone = 2;
				} else
				{
					textChange(levelsGroup, pos_x, 200);
					game.add.tween(levelsGroup2).to({ x: change_x1 }, 150, 'Linear', true);
					game.add.tween(levelsGroup).to({ x: change_x2 }, 150, 'Linear', true);
					game.naFone = 1;
				}

				function textChange(g, x, y)
				{
					for (var i = 0; i < 40; i += 2)
					{
						if (game.number > player.level) // открытый уровень
						{
							g.getChildAt(i).loadTexture("zamok", 0);
							g.getChildAt(i + 1).visible = false;
						} else
						{
							g.getChildAt(i + 1).text = game.number;
							g.getChildAt(i + 1).visible = true;
							g.getChildAt(i).loadTexture("levels", 0);
						}
						game.number++;
					}
					g.position.set(x, y);
				}
			}

			// Функция вызывается перед стартом загрузки
			function loadStart()
			{

			}

			// Функция выполняется во время загрузки и показывает процент
			function fileComplete(progress, cacheKey, success, totalLoaded, totalFiles)
			{
				//text.setText("File Complete: " + progress + "% - " + totalLoaded + " out of " + totalFiles);
			}

			// Функция вызывается после окончания загрузки
			function loadComplete()
			{
				// Отображаем на поле загруженные изображения
				addImage();

				// Задержка перед перемешиванием
				setTimeout(player.peremeshka, 1000);

				progressBar.visible = false;
				progressBarFon.visible = false;
			}

			function addUserVk()
			{
				VK.callMethod("showInviteBox");
			}
		</script>
		<script type="text/javascript" src="js/buttons.js?v=2">
		</script>
		<script type="text/javascript" src="js/jquerypp.custom.js">
		</script>
	</body>
</html>